<?php/* Add this on all pages on top. */set_include_path($_SERVER['DOCUMENT_ROOT'].'/'.PATH_SEPARATOR.$_SERVER['DOCUMENT_ROOT'].'/library/classes/');/*** Standard includes */require_once 'config/database.php';require_once 'config/smarty.php';/*** Check for login */require_once 'includes/auth.php';/* objects. */require_once 'class/video.php';$videoObject	= new class_video();if (isset($_GET['code']) && trim($_GET['code']) != '') {		$code = trim($_GET['code']);		$videoData = $videoObject->getByCode($code);		if($videoData) {		$smarty->assign('videoData', $videoData);	} else {		header('Location: /video/');		exit;			}}/* Check posted data. */if(count($_POST) > 0) {	$errorArray		= array();	$data 				= array();	$formValid		= true;	$success			= NULL;		if(isset($_POST['video_name']) && trim($_POST['video_name']) == '') {		$errorArray['video_name'] = 'Please add a name';		$formValid = false;			}		if(isset($_POST['video_url']) && trim($_POST['video_url']) == '') {		$errorArray['video_url'] = 'Please add a url';		$formValid = false;			} else {				if($videoObject->validateUrl(trim($_POST['video_url'])) == '') {					$errorArray['video_url'] = "Please add a valid video link, i.e. http://www.youtube.com/embed/CY_r9jcFajg";			$formValid = false;									}			}		if(count($errorArray) == 0 && $formValid == true) {				$data 	= array();								$data['video_name']	= trim($_POST['video_name']);							$data['video_url']		= trim($_POST['video_url']);						if(!isset($videoData)) {			$success = $videoObject->insert($data);						} else {			$where		= $videoObject->getAdapter()->quoteInto('video_code = ?', $videoData['video_code']);			$videoObject->update($data, $where);					$success 	= $videoData['video_code'];					}				if(count($errorArray) == 0) {			header('Location: /video/');				exit;				}	}		/* if we are here there are errors. */	$smarty->assign('errorArray', $errorArray);	}$smarty->display('video/details.tpl');?>