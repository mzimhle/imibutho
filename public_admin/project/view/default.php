<?php/* Add this on all pages on top. */
set_include_path($_SERVER['DOCUMENT_ROOT'].'/'.PATH_SEPARATOR.$_SERVER['DOCUMENT_ROOT'].'/library/classes/');/*** Standard includes */require_once 'config/database.php';
require_once 'config/smarty.php';/** * Check for login */require_once 'includes/auth.php';require_once 'class/project.php';$projectObject = new class_project();  if(isset($_GET['delete_code'])) {		$errorArray				= array();	$errorArray['error']	= '';	$errorArray['result']	= 0;		$formValid				= true;	$success					= NULL;	$code						= trim($_GET['delete_code']);			if($errorArray['error']  == '' && $errorArray['result']  == 0 ) {		$data	= array();		$data['project_deleted'] = 1;		$data['project_code'] = $code;				$where = $projectObject->getAdapter()->quoteInto('project_code = ?', $code);		$success	= $projectObject->update($data, $where);					if(is_numeric($success) && $success > 0) {			$errorArray['error']	= '';			$errorArray['result']	= 1;					} else {			$errorArray['error']	= 'Could not delete, please try again.';			$errorArray['result']	= 0;						}	}		echo json_encode($errorArray);	exit;}/* Setup Pagination. */if(isset($_GET['action']) && trim($_GET['action']) == 'projectsearch') {	$search = isset($_REQUEST['search']) && trim($_REQUEST['search']) != '' ? trim($_REQUEST['search']) : null;	$start 	= isset($_REQUEST['iDisplayStart']) ? $_REQUEST['iDisplayStart'] : 0;	$length = isset($_REQUEST['iDisplayLength']) ? $_REQUEST['iDisplayLength'] : 20;		$jobData = $projectObject->getSearch($search, $start, $length);	$alljobs = array();	if($jobData) {		for($i = 0; $i < count($jobData['records']); $i++) {			$item = $jobData['records'][$i];			$alljobs[$i] = array(						($item['project_image_path'] == '' ? '<img src="/images/avatar.jpg" width="60" />' : '<img src="http://www.imibutho.co.za'.$item['project_image_path'].'tny_'.$item['project_image_name'].$item['project_image_ext'].'" width="60" />'),							$item['project_added'],												$item['areapost_name'], 						'<a class="'.($item['project_active'] == 0 ? 'error' : 'success').'" href="/project/view/details.php?code='.$item['project_code'].'">'.$item['project_name'].'</a>', 						$item['project_date_start'].($item['project_date_end'] != '' ? ' <br />till '.$item['project_date_end'] : ''), 						$item['project_description'],						'<button onclick="javascript:deleteitem(\''.$item['project_code'].'\');">Delete</button>');		}	}					if($jobData) {		$response['sEcho'] = $_REQUEST['sEcho'];		$response['iTotalRecords'] = $jobData['displayrecords'];				$response['iTotalDisplayRecords'] = $jobData['count'];		$response['aaData']	= $alljobs;	} else {		$response['result'] 	= false;		$response['message']	= 'There are no items to show.';				}	    echo json_encode($response);    die();	}/* End Pagination Setup. */$smarty->display('project/view/default.tpl');?>